a,z,i,j,d[9999][9];main(k){scanf("%d ",&a);d[a][2]=1;for(i=a;i--;){a=getchar()%4-1;for(j=8;j--;z+=d[0][j])for(k=8;k--;)d[i][j]+=j&k&&j>>a&1?d[i+1][k]%10007:0;}!printf("%d\n",z%10007);}