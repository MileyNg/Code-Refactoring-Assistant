a[9999],i,j,z,t,c;main(p){for(;a[2]=read(i=0,&c,1);)for(t*=c<60||!--z;++j&7||++i&7;)i&j&&i>>~-c%4&c>60?a[i-z*9]+=p=a[j%8+~z*9]%10007,t+=p:0;t=!printf("%d\n",t%10007);}