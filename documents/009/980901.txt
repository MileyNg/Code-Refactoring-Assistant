a,z,u,i,j,d[9999][9];main(k){d[0][2]=scanf("%d ",&a);for(;i<a;i++){u=getchar()%4-1;for(j=8;j--;z+=d[a][j])for(k=8;k--;)d[i+1][j]+=j&k&&j>>u&1?d[i][k]%10007:0;}a=!printf("%d\n",z%10007);}