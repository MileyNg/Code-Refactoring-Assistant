a[9999],i,j,z,t,c;main(p){for(;i=a[2]=read(0,&c,1)||!printf("%d\n",t%10007);)for(t*=c<60||!--z;++j&7||++i&7;)i&j&&i>>~-c%4&c>60?a[i-z*9]+=p=a[j%8+~z*9]%10007,t+=p:0;}