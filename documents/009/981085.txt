a[9][1010],i,j,z,t,c;main(p){for(;*a[2]=read(i=0,&c,1)||!printf("%d\n",t%10007);)for(t*=c<60||!++z;++j&7||++i&7;)i&j&&i>>~-c%4&c>60?a[i][z]+=p=a[j&7][z-1]%10007,t+=p:0;}