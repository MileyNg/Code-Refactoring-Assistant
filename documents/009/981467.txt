N;M=10007;d[9999];main(i,j,k,c){for(d[2]=scanf("%d\n",&N);c=getchar(),c-10;i++)for(j=0;j<8;j++)for(k=0;j&1<<c%4-1&&k<8;j&k++?d[i*8+j]+=d[i*8+k-9],d[i*8+j]%=M:0);for(j=k=0;k<8;j%=M)j+=d[N*8+k++];N=!printf("%d\n",j);}