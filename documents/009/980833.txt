int a[999][8],n,t,s,i,j,k;main(){scanf("%d ",&n);a[0][2]=1;for(i=0;i<n;i++){s=getchar()%4-1;j=8;while(j--){k=8;while(k--){if(j&k&&j>>s&1)a[i+1][j]+=a[i][k]%10007;}t+=a[n][j];}}printf("%d\n",t%10007);}