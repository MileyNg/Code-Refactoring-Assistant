int a[1999][9],z,u,n,i,j,k;main(){scanf("%d ",&n);a[0][2]=1;for(i=0;i<n;i++){u=getchar()%4-1;fprintf(stderr,"%d\n",u);for(j=8;j--;){for(k=8;k--;)if(j&k&&j>>u&1)a[i+1][j]+=a[i][k]%10007;z+=a[n][j];}}printf("%d\n",z%10007);}