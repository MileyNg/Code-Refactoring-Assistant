int a[9999][8],z,u,n,i,j,k;main(){scanf("%d ",&n);a[0][2]=1;for(i=0;i<n;i++){u=getchar()%4-1;j=8;while(j--){k=8;while(k--){if(j&k&&j>>u&1)a[i+1][j]+=a[i][k]%10007;}z+=a[n][j];}}printf("%d\n",z%10007);}